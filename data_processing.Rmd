---
title: "Data Processing"
output: html_document
date: "2023-09-25"
---

```{r}
library(xlsx)
library(tidyverse)
```

```{r}
# load original data
missiles <- read.xlsx("Missiles_datageocoding_prep.xlsx", 1)
facs <- read.xlsx("NL_geocoded_working.xlsx",1)

# cleanup 
facs <- facs %>% select(-NA.) # remove random column
colnames(facs) <- c("country", "country_code", "facility_name", "coordinates", "start_date") # rename columns
facs <- facs %>%
  mutate(coordinates = gsub(",", ".", coordinates)) %>% # fix inconsistency in coords
  filter(!is.na(coordinates)) # remove rows with no coords (why do these exist?)

facs <- facs %>% 
  mutate(lat = lapply(strsplit(coordinates, "[.]"), function(x) paste(x[1], x[2], sep = ".")),
         lng = lapply(strsplit(coordinates, "[.]"), function(x) paste(x[3], x[4], sep = ".")))

facs <- facs[, c("facility_name", "country", "country_code", "coordinates", "lat", "lng", "start_date")] # reorder columns

write.csv(facs, "facilities.csv")

# build parsimonious dataframes with the necessary facilities, capture occurrences to be fed into the visualization
```
