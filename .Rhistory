View(fac_caps)
runApp()
runApp()
runApp()
runApp()
sat <- read_csv("sat.csv")[-1] # satellite photo polygons
library(tidyverse)
sat <- read_csv("sat.csv")[-1] # satellite photo polygons
sat <- read_csv("sat.csv")[-1] # satellite photo polygons
# does sat.csv contain polygons from all 3 declassified documents?
getwd()
sat3 <- read_csv("declassified3.csv") # need to clean up coords n shit
View(sat)
shiny::runApp()
runApp()
# earliest date should be 1960, latest 1984
min(sat$Acquisitio)
# earliest date should be 1960, latest 1984
max(sat$Acquisitio)
sat3 <- read_csv("../CORONA_original_data/declassified3.csv") # need to clean up coords n shit
sat3 <- read_csv(".../CORONA_original_data/declassified3.csv") # need to clean up coords n shit
sat3 <- read_csv(".../CORONA_original_data/sat3.csv") # need to clean up coords n shit
sat3 <- read_csv("sat3.csv") # need to clean up coords n shit
View(sat3)
setdiff(colnames(sat), colnames(sat3))
declass3 <- st_read("./declassiii/declassiii.shp")
library(sf)
declass3 <- st_read("./declassiii/declassiii.shp")
declass3 <- st_read("./declassified3/declassiii.shp")
View(declass3)
View(declass3[[2]][[1]])
setdiff(colnames(sat), colnames(sat3))
# need to clean up coords n shit
sat2 <- read_csv("sat2.csv")
View(sat2)
setdiff(colnames(sat2), colnames(sat3))
# need to clean up coords n shit
sat1 <- read_csv("sat1.csv")
setdiff(colnames(sat1), colnames(sat3))
setdiff(colnames(sat1), colnames(sat2))
View(sat1)
setdiff(colnames(sat2), colnames(sat1))
setdiff(colnames(sat1), colnames(sat2))
setdiff(colnames(sat2), colnames(sat1))
setdiff(colnames(sat1), colnames(sat2))
setdiff(colnames(sat1), colnames(sat2))
setdiff(colnames(sat2), colnames(sat1))
?cbind
setdiff(colnames(sat1), colnames(sat2))
# sat2 needs direction flag
sat2$`Direction Flag` <- rep(NA, nrow(sat2))
setdiff(colnames(sat1), colnames(sat2))
setdiff(colnames(sat2), colnames(sat1))
# sat1 needs segment count, operations number
sat1$`Segment Count` <- rep(NA, nrow(sat1))
sat1$`Operations Number` <- rep(NA, nrow(sat1))
setdiff(colnames(sat2), colnames(sat1))
setdiff(colnames(sat1), colnames(sat2))
setdiff(colnames(sat1), colnames(sat2))
colnames(sat1)[colnames(sat1) == "NW Cormer Lat dec"] <- "NW Corner Lat dec"
setdiff(colnames(sat2), colnames(sat1))
setdiff(colnames(sat1), colnames(sat2))
setdiff(colnames(sat2), colnames(sat1))
setdiff(colnames(sat3), colnames(sat1))
setdiff(colnames(sat1), colnames(sat3))
setdiff(colnames(sat3), colnames(sat1))
setdiff(colnames(sat1), colnames(sat3))
setdiff(colnames(sat1), colnames(sat3))
sat1_2 <- rbind(sat1,sat2)
# fix column inefficiences
setdiff(colnames(sat1), colnames(sat2))
837088 + 46699
View(sat1_2)
sat1$`Data Source` <- rep("declass1", nrow(sat1))
sat2$`Data Source` <- rep("declass2", nrow(sat2))
sat1_2 <- rbind(sat1,sat2)
View(sat1_2)
setdiff(colnames(sat1_2), colnames(sat3))
setdiff(colnames(sat3), colnames(sat1_2))
# sat3 needs Frame, Direction Flag, Camera Type, Segment Count
sat3$`Data Source` <- rep("declass3", nrow(sat3))
setdiff(colnames(sat1_2), colnames(sat3))
setdiff(colnames(sat3), colnames(sat1_2))
View(sat1_2)
# camera Type
unique(sat1_2$`Camera Type`)
unique(sat3$Camera)
# camera Type
unique(sat1_2$`Camera Type`)
unique(sat3$Camera)
setdiff(colnames(sat1_2), colnames(sat3))
setdiff(colnames(sat3), colnames(sat1_2))
# camera Type
sat3 <- sat3 %>%
mutate(`Camera Type` = str_replace(Camera, "A", "High Resolution Surveillance Camera - Aft")) %>%
mutate(`Camera Type` = str_replace(`Camera Type`, "F", "High Resolution Surveillance Camera - Forward")) %>%
mutate(`Camera Type` = str_replace(`Camera Type`, "T", "Lower Resolution Terrain Mapping Camera"))
unique(sat1_2$`Camera Type`)
unique(sat3$Camera)
unique(sat3$Camera)
unique(sat3$`Camera Type`)
# camera Type
sat3 <- sat3 %>%
mutate(`Camera Type` = str_replace(Camera, "A", "High Resolution Surveillance Camera - Aft")) %>%
mutate(`Camera Type` = str_replace(`Camera Type`, "F", "High Resolution Surveillance Camera - Forward")) %>%
mutate(`Camera Type` = str_replace(`Camera Type`, "T", "Lower Resolution Terrain Mapping Camera")) %>%
select(-Camera)
setdiff(colnames(sat1_2), colnames(sat3))
unique(sat3$`Camera Type`)
setdiff(colnames(sat3), colnames(sat1_2))
setdiff(colnames(sat1_2), colnames(sat3))
setdiff(colnames(sat3), colnames(sat1_2))
colnames(sat1_2)[colnames(sat1_2) == "Frame"] <- "Frame Number"
setdiff(colnames(sat3), colnames(sat1_2))
setdiff(colnames(sat1_2), colnames(sat3))
colnames(sat1_2)[colnames(sat1) == "Down Load Available"] <- "Download Available"
setdiff(colnames(sat1_2), colnames(sat3))
setdiff(colnames(sat3), colnames(sat1_2))
sat3$`Direction Flag` <- rep(NA, nrow(sat3))
sat3$`Segment Count` <- rep(NA, nrow(sat3))
setdiff(colnames(sat1_2), colnames(sat3))
View(sat1)
View(sat)
sat <- rbind(sat1_2, sat3)
write_csv(sat, "sat.csv")
id <- sat1_2$`Display ID`[[1]]
strsplit(id, ",")
strsplit(id, ",")[[1]]
strsplit(id, ",")[[1]][1]
id <- strsplit(id, ",")[[1]][1]
id[0:6]
id[1:6]
substr(id, 1, 6)
substr(id, 7, 16)
id <- paste(substr(id, 1, 6), "-", substr(id, 7, 16))
id <- strsplit(id, ",")[[1]][1]
id <- sat1_2$`Display ID`[[1]]
id <- strsplit(id, ",")[[1]][1]
id <- paste(substr(id, 1, 6), "-", substr(id, 7, 16), sep = "")
id <- strsplit(id, ",")[[1]][1]
id <- sat1_2$`Display ID`[[1]]
id <- strsplit(id, ",")[[1]][1]
id <- paste(substr(id, 1, 6), "-", substr(id, 7, 16), sep = "")
id <- sat1_2$`Display ID`[[1]]
?cat
lengths <- c()
for(id in sat1_2$`Display ID`){
lengths <- cat(lengths, length(id))
}
lengths <- c()
for(id in sat1_2$`Display ID`){
lengths <- append(lengths, length(id))
}
sat1_2$`Display ID`
for(id in sat1_2$`Display ID`){
# lengths <- append(lengths, length(id))
}
for(id in sat1_2$`Display ID`){
1+1
# lengths <- append(lengths, length(id))
}
for(id in sat1_2$`Display ID`){
lengths <- c(lengths, length(id))
}
lengths <- c()
for(id in sat1_2$`Display ID`){
lengths <- c(lengths, length(id))
}
length(id)
nchar(id)
id <- strsplit(id, ",")[[1]][1]
nchar(id)
lengths <- c()
for(id in sat1_2$`Display ID`){
id <- strsplit(id, ",")[[1]][1]
lengths <- c(lengths, nchar(id))
}
min(lengths)
max(lengths)
lengths_copy <- lengths
lengths <- c()
for(id in sat2$`Display ID`){
id <- strsplit(id, ",")[[1]][1]
lengths <- c(lengths, nchar(id))
}
max(lengths)
min(lengths)
View(sat2)
# reformat Display ID for sat1, sat2 due to bad formatting in CSV provided by USGS
reformat_id <- function(id, n) {
id <- strsplit(id, ",")[[1]][1] # split by comma, take first item
# after the right n of characters insert "-"
new_id <- paste(substr(id, 1, n), "-", substr(id, n+1, length(id)), sep = "")
}
sat2 <- sat2 %>% mutate(`Display ID` = reformat_id(`Display ID`, n = 7))
View(sat2)
sat2 <- sat2 %>% mutate(`Display ID` = reformat_id(`Display ID`, n = 7))
unique(sat2$`Display ID`)
sat2 <- read_csv("sat2.csv")
# reformat Display ID for sat1, sat2 due to bad formatting in CSV provided by USGS
reformat_id <- function(id, n) {
id <- strsplit(id, ",")[[1]][1] # split by comma, take first item
# after the right n of characters insert "-"
new_id <- paste(substr(id, 1, n), "-", substr(id, n+1, length(id)), sep = "")
}
sat2$`Display ID`[[1]]
reformat_id(sat2$`Display ID`[[1]], n = 7)
# reformat Display ID for sat1, sat2 due to bad formatting in CSV provided by USGS
reformat_id <- function(id, n) {
id <- strsplit(id, ",")[[1]][1] # split by comma, take first item
# after the right n of characters insert "-"
new_id <- paste(substr(id, 1, n), "-", substr(id, n+1, length(id)), sep = "")
new_id
}
reformat_id(sat2$`Display ID`[[1]], n = 7)
id = sat2$`Display ID`[[1]]
id
id <- strsplit(id, ",")[[1]][1] # split by comma, take first item
id
substr(id, 1, n)
n = 7
substr(id, 1, n)
substr(id, n+1, length(id))
n+1
length(id)
# reformat Display ID for sat1, sat2 due to bad formatting in CSV provided by USGS
reformat_id <- function(id, n) {
id <- strsplit(id, ",")[[1]][1] # split by comma, take first item
# after the right n of characters insert "-"
new_id <- paste(substr(id, 1, n), "-", substr(id, n+1, nchar(id)), sep = "")
new_id
}
reformat_id(sat2$`Display ID`[[1]], n = 7)
id
sat2 <- sat2 %>% mutate(`Display ID` = reformat_id(`Display ID`, n = 7))
sat2 <- read_csv("sat2.csv")
sat2 <- sat2 %>% mutate(`Display ID` = reformat_id(`Display ID`, n = 7))
sat2 <- read_csv("sat2.csv")
sat2 <- sat2 %>% mutate(`Display ID` = reformat_id(id = `Display ID`, n = 7))
sat2 <- read_csv("sat2.csv")
sat2 <- sat2 %>% mutate(`Display ID 2` = reformat_id(id = `Display ID`, n = 7))
sat2 <- sat2 %>% mutate(`Display ID 2` = `Display ID`)
reformat_id(sat2$`Display ID`[[2]], n = 7)
reformat_id(sat2$`Display ID`[[10]], n = 7)
sat2 <- sat2 %>% mutate(`Display ID 2` = reformat_id(id = `Display ID`, n = 7))
?lapply
lapply(sat2$`Display ID`, reformat_id(n = 7))
lapply(sat2$`Display ID`, reformat_id, n = 7)
sat2 <- read_csv("sat2.csv")
sat2$`Display ID` <- lapply(sat2$`Display ID`, reformat_id, n = 7)
# need to clean up coords n shit
sat1 <- read_csv("sat1.csv")
sat2 <- read_csv("sat2.csv")
sat3 <- read_csv("sat3.csv")
# fix column inconsistencies
setdiff(colnames(sat2), colnames(sat1))
sat1$`Segment Count` <- rep(NA, nrow(sat1))
sat1$`Operations Number` <- rep(NA, nrow(sat1))
colnames(sat1)[colnames(sat1) == "NW Cormer Lat dec"] <- "NW Corner Lat dec"
sat1$`Data Source` <- rep("declass1", nrow(sat1))
setdiff(colnames(sat1), colnames(sat2))
sat2$`Direction Flag` <- rep(NA, nrow(sat2))
sat2$`Data Source` <- rep("declass2", nrow(sat2))
# reformat Display ID for sat1, sat2 due to bad formatting in CSV provided by USGS
reformat_id <- function(id, n) {
id <- strsplit(id, ",")[[1]][1] # split by comma, take first item
# after the right n of characters insert "-"
new_id <- paste(substr(id, 1, n), "-", substr(id, n+1, nchar(id)), sep = "")
new_id
}
sat1$`Display ID` <- lapply(sat1$`Display ID`, reformat_id, n = 6)
sat2$`Display ID` <- lapply(sat2$`Display ID`, reformat_id, n = 7)
sat1_2 <- rbind(sat1,sat2)
setdiff(colnames(sat1_2), colnames(sat3))
sat3 <- sat3 %>%
mutate(`Camera Type` = str_replace(Camera, "A", "High Resolution Surveillance Camera - Aft")) %>%
mutate(`Camera Type` = str_replace(`Camera Type`, "F", "High Resolution Surveillance Camera - Forward")) %>%
mutate(`Camera Type` = str_replace(`Camera Type`, "T", "Lower Resolution Terrain Mapping Camera")) %>%
select(-Camera)
colnames(sat1_2)[colnames(sat1_2) == "Frame"] <- "Frame Number"
colnames(sat1_2)[colnames(sat1) == "Down Load Available"] <- "Download Available"
sat3$`Direction Flag` <- rep(NA, nrow(sat3))
sat3$`Segment Count` <- rep(NA, nrow(sat3))
sat3$`Data Source` <- rep("declass3", nrow(sat3))
sat <- rbind(sat1_2, sat3)
write_csv(sat, "sat.csv")
View(sat)
# need to clean up coords n shit
sat1 <- read_csv("sat1.csv")
# need to clean up coords n shit
sat1 <- read_csv("sat1.csv")
sat2 <- read_csv("sat2.csv")
sat3 <- read_csv("sat3.csv")
View(sat1)
View(sat2)
dids <- unique(sat2$`Display ID`)
grepl("-", dids)
which(grepl("-", dids))
dids[17610]
dids[1]
dids[17610]
length(dids[17610])
nchar(dids[17610])
nchar(dids[1])
sat2 <- read_csv("sat2.csv")
dids <- unique(sat2$`Display ID`)
nchar(dids[1])
nchar(dids[17610])
dids[17610]
nchar(dids[1])
dids[1]
# reformat Display ID for sat1, sat2 due to bad formatting in CSV provided by USGS
reformat_id <- function(id, n) {
id <- strsplit(id, ",")[[1]][1] # split by comma, take first item
id
# this code inserted a "-", but I don't think that is actually necessary:
# # after the right n of characters insert "-"
# new_id <- paste(substr(id, 1, n), "-", substr(id, n+1, nchar(id)), sep = "")
# new_id
}
# need to clean up coords n shit
sat1 <- read_csv("sat1.csv")
sat2 <- read_csv("sat2.csv")
sat3 <- read_csv("sat3.csv")
# fix column inconsistencies
setdiff(colnames(sat2), colnames(sat1))
sat1$`Segment Count` <- rep(NA, nrow(sat1))
sat1$`Operations Number` <- rep(NA, nrow(sat1))
colnames(sat1)[colnames(sat1) == "NW Cormer Lat dec"] <- "NW Corner Lat dec"
sat1$`Data Source` <- rep("declass1", nrow(sat1))
setdiff(colnames(sat1), colnames(sat2))
sat2$`Direction Flag` <- rep(NA, nrow(sat2))
sat2$`Data Source` <- rep("declass2", nrow(sat2))
# reformat Display ID for sat1, sat2 due to bad formatting in CSV provided by USGS
reformat_id <- function(id, n) {
id <- strsplit(id, ",")[[1]][1] # split by comma, take first item
id
# this code inserted a "-", but I don't think that is actually necessary:
# # after the right n of characters insert "-"
# new_id <- paste(substr(id, 1, n), "-", substr(id, n+1, nchar(id)), sep = "")
# new_id
}
sat1$`Display ID` <- lapply(sat1$`Display ID`, reformat_id, n = 6)
sat2$`Display ID` <- lapply(sat2$`Display ID`, reformat_id, n = 7)
sat1_2 <- rbind(sat1,sat2)
setdiff(colnames(sat1_2), colnames(sat3))
sat3 <- sat3 %>%
mutate(`Camera Type` = str_replace(Camera, "A", "High Resolution Surveillance Camera - Aft")) %>%
mutate(`Camera Type` = str_replace(`Camera Type`, "F", "High Resolution Surveillance Camera - Forward")) %>%
mutate(`Camera Type` = str_replace(`Camera Type`, "T", "Lower Resolution Terrain Mapping Camera")) %>%
select(-Camera)
colnames(sat1_2)[colnames(sat1_2) == "Frame"] <- "Frame Number"
colnames(sat1_2)[colnames(sat1) == "Down Load Available"] <- "Download Available"
sat3$`Direction Flag` <- rep(NA, nrow(sat3))
sat3$`Segment Count` <- rep(NA, nrow(sat3))
sat3$`Data Source` <- rep("declass3", nrow(sat3))
sat <- rbind(sat1_2, sat3)
write_csv(sat, "sat.csv")
View(sat)
View(sat)
st_as_sf
?st_as_sf
?st_polygon
sat_test <- head(sat, 100)
st_as_sf(sat_test, coords = c("NW Corner Lat dec", "NW Corner Long dec", "NE Corner Long dec", "NE Corner Long dec", "SW Corner Lat dec", "SW Corner Long dec", "SE Corner Long dec", "SE Corner Long dec"))
sat_test <- sat_test %>%
mutate(geometry = paste("POLYGON ((", `NW Corner Lat dec`, " ", `NE Corner Lat dec` sep = ""))
sat_test <- sat_test %>%
mutate(geometry = paste("POLYGON ((", `NW Corner Lat dec`, " ", `NE Corner Lat dec` sep = "")))
sat_test <- sat_test %>%
mutate(geometry = paste("POLYGON ((", `NW Corner Lat dec`, " ", `NE Corner Lat dec`, sep = ""))
View(sat_test)
sat_test <- sat_test %>%
mutate(geometry = paste("POLYGON ((", `NW Corner Lat dec`, " ", `NW Corner Long dec`, ",",
`NE Corner Long dec`, " ", `NE Corner Long dec`, ",",
`SW Corner Lat dec`, " ", `SW Corner Long dec`, ",",
`SE Corner Long dec`, " ", `SE Corner Long dec`, "))", sep = ""))
sat_test$geometry[[1]]
sat <- sat %>%
mutate(geometry = paste("POLYGON ((",
`NW Corner Lat dec`, " ", `NW Corner Long dec`, ",",
`NE Corner Lat dec`, " ", `NE Corner Long dec`, ",",
`SE Corner Lat dec`, " ", `SE Corner Long dec`, ",",
`SW Corner Lat dec`, " ", `SW Corner Long dec`, "))", sep = ""))
View(sat_test)
sat_test <- sat_test[, -c(13:32)]
View(sat_test)
setdiff(colnames(sat), colnames(sat_test))
sat <- sat[, -c(13:32)]
sat_sf <- st_as_sf(sat, wkt = "geometry")
sat_sf <- sat_sf %>% mutate(polygon_geometry = geometry) # duplicate polygons because otherwise they'll be removed
facs <- read_csv("facilities.csv")[-1]
missiles <- read_csv("missiles.csv")[-1]
sat <- read_csv("sat.csv")[-1] # satellite photo polygons
# make wkt representation of sat geometry
sat <- sat %>%
mutate(geometry = paste("POLYGON ((",
`NW Corner Lat dec`, " ", `NW Corner Long dec`, ",",
`NE Corner Lat dec`, " ", `NE Corner Long dec`, ",",
`SE Corner Lat dec`, " ", `SE Corner Long dec`, ",",
`SW Corner Lat dec`, " ", `SW Corner Long dec`, "))", sep = ""))
sat <- sat[, -c(13:32)]
write_csv(sat, "sat.csv")
# Perform a spatial join to find points within polygons
fac_captures <- st_join(x = facs_sf, y = sat_sf, join = st_within)
# create Simple Features DFs
facs_sf <- st_as_sf(facs, coords = c("lng", "lat"), remove = FALSE)
# Perform a spatial join to find points within polygons
fac_captures <- st_join(x = facs_sf, y = sat_sf, join = st_within)
View(facs_sf)
View(sat_sf)
View(sat_sf[[17]][[1]])
test_sf <- st_as_sf(sat_test, wkt = "geometry")
test_captures <- st_join(x = facs_sf, y = sat_sf, join = st_within)
test_captures <- st_join(x = facs_sf, y = test_sf, join = st_within)
facs <- read_csv("facilities.csv")[-1]
missiles <- read_csv("missiles.csv")[-1]
# need to clean up coords n shit
sat1 <- read_csv("sat1.csv")
sat2 <- read_csv("sat2.csv")
sat3 <- read_csv("sat3.csv")
# fix column inconsistencies
setdiff(colnames(sat2), colnames(sat1))
sat1$`Segment Count` <- rep(NA, nrow(sat1))
sat1$`Operations Number` <- rep(NA, nrow(sat1))
colnames(sat1)[colnames(sat1) == "NW Cormer Lat dec"] <- "NW Corner Lat dec"
sat1$`Data Source` <- rep("declass1", nrow(sat1))
setdiff(colnames(sat1), colnames(sat2))
sat2$`Direction Flag` <- rep(NA, nrow(sat2))
sat2$`Data Source` <- rep("declass2", nrow(sat2))
# reformat Display ID for sat1, sat2 due to bad formatting in CSV provided by USGS
reformat_id <- function(id, n) {
id <- strsplit(id, ",")[[1]][1] # split by comma, take first item
id
# this code inserted a "-", but I don't think that is actually necessary:
# # after the right n of characters insert "-"
# new_id <- paste(substr(id, 1, n), "-", substr(id, n+1, nchar(id)), sep = "")
# new_id
}
sat1$`Display ID` <- lapply(sat1$`Display ID`, reformat_id, n = 6)
sat2$`Display ID` <- lapply(sat2$`Display ID`, reformat_id, n = 7)
sat1_2 <- rbind(sat1,sat2)
setdiff(colnames(sat1_2), colnames(sat3))
sat3 <- sat3 %>%
mutate(`Camera Type` = str_replace(Camera, "A", "High Resolution Surveillance Camera - Aft")) %>%
mutate(`Camera Type` = str_replace(`Camera Type`, "F", "High Resolution Surveillance Camera - Forward")) %>%
mutate(`Camera Type` = str_replace(`Camera Type`, "T", "Lower Resolution Terrain Mapping Camera")) %>%
select(-Camera)
colnames(sat1_2)[colnames(sat1_2) == "Frame"] <- "Frame Number"
colnames(sat1_2)[colnames(sat1) == "Down Load Available"] <- "Download Available"
sat3$`Direction Flag` <- rep(NA, nrow(sat3))
sat3$`Segment Count` <- rep(NA, nrow(sat3))
sat3$`Data Source` <- rep("declass3", nrow(sat3))
sat <- rbind(sat1_2, sat3)
# make wkt representation of sat geometry
sat <- sat %>%
mutate(geometry = paste("POLYGON ((",
`NW Corner Lat dec`, " ", `NW Corner Long dec`, ",",
`NE Corner Lat dec`, " ", `NE Corner Long dec`, ",",
`SE Corner Lat dec`, " ", `SE Corner Long dec`, ",",
`SW Corner Lat dec`, " ", `SW Corner Long dec`, ",",
`NW Corner Lat dec`, " ", `NW Corner Long dec`, "))", sep = ""))
sat <- sat[, -c(13:32)]
write_csv(sat, "sat.csv")
sat_test <- head(sat, 100)
test_sf <- st_as_sf(sat_test, wkt = "geometry")
test_sf <- st_as_sf(sat_test, wkt = "geometry")
test_captures <- st_join(x = facs_sf, y = test_sf, join = st_within)
View(test_sf)
View(test_captures)
# create Simple Features DFs
facs_sf <- st_as_sf(facs, coords = c("lng", "lat"), remove = FALSE)
miss_sf <- st_as_sf(missiles, coords = c("lng", "lat"), remove = FALSE)
sat_sf <- st_as_sf(sat, wkt = "geometry")
sat_sf <- sat_sf %>% mutate(polygon_geometry = geometry) # duplicate polygons because otherwise they'll be removed
# Perform a spatial join to find points within polygons
fac_captures <- st_join(x = facs_sf, y = sat_sf, join = st_within)
# convert SF geometry columns to characters to avoid CSV file formatting issues
fac_captures$geometry <- st_as_text(fac_captures$geometry)
fac_captures$polygon_geometry <- st_as_text(fac_captures$polygon_geometry)
# filter the dataset to remove cases where the photo was taken before construction started
fac_captures <- fac_captures %>%
filter(start_date <= `Acquisition Date`) %>%
as.data.frame() # convert from SF back to regular DF
write.csv(fac_captures, "fac_captures.csv")
View(fac_captures)
# Use sapply to get column data types
column_types <- sapply(df, class)
# Print the column data types
print(column_types)
# Use sapply to get column data types
column_types <- sapply(fac_captures, class)
# Print the column data types
print(column_types)
fac_captures$`Display ID` <- as.character(fac_captures$`Display ID`)
# Use sapply to get column data types
column_types <- sapply(fac_captures, class)
# Print the column data types
print(column_types)
write.csv(fac_captures, "fac_captures.csv")
# Perform a spatial join to find points within polygons
miss_captures <- st_join(x = miss_sf, y = sat_sf, join = st_within)
# convert SF geometry columns to characters to avoid CSV file formatting issues
miss_captures$geometry <- st_as_text(miss_captures$geometry)
miss_captures$polygon_geometry <- st_as_text(miss_captures$polygon_geometry)
# filter the dataset to remove cases where the photo was taken before construction started
miss_captures <- miss_captures %>%
filter(start_date <= `Acquisition Date`,
ifelse(!is.na(end_date), end_date >= `Acquisition Date`, TRUE)) %>%
as.data.frame() # convert from SF back to regular DF
miss_captures$`Display ID` <- as.character(miss_captures$`Display ID`)
write.csv(miss_captures, "miss_captures.csv")
